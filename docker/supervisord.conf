[supervisord]
nodaemon=true
logfile=/dev/null
pidfile=/var/run/supervisord.pid

[program:php-fpm]
command=docker-php-entrypoint php-fpm
autostart=true
autorestart=true
priority=5
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr

; Worker xử lý 1 job/lần (--once), Supervisor tự khởi động lại để chạy job tiếp theo
[program:queue-worker]
command=php artisan queue:work redis --once --timeout=300 --tries=3
directory=/var/www
autostart=true
autorestart=true
startretries=10
priority=10
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr

[program:nginx]
command=/usr/sbin/nginx -g "daemon off;"
autostart=true
autorestart=true
priority=20
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr
